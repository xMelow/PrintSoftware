<ui:FluentWindow x:Class="PrintSoftware.MainWindow"
                 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                 xmlns:vm="clr-namespace:PrintSoftware.ViewModels"
                 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                 xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
                 xmlns:global="clr-namespace:"
                 mc:Ignorable="d"
                 Title="Label Printing"
                 Width="1500" Height="800"
                 ResizeMode="CanResize"
                 WindowBackdropType="Mica"
                 WindowCornerPreference="Round"
                 ExtendsContentIntoTitleBar="True">

    <Window.DataContext>
        <vm:MainWindowViewModel />
    </Window.DataContext>

    <Grid>
        <!-- HEADER -->
        <DockPanel Background="#008896" LastChildFill="True" Margin="0,0,0,740"
                   MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
            <TextBlock Text="Altec Label Printing" VerticalAlignment="Center" Margin="10,0,0,0" FontWeight="Bold" Foreground="White" FontSize="25"/>
            <StackPanel Margin="10" Orientation="Horizontal" HorizontalAlignment="Right">
                <Button Content="―" Width="35" Height="30" Click="MinimizeButton_Click"/>
                <Button Content="□" Width="35" Height="30" Click="MaximizeButton_Click"/>
                <Button Content="✕" Width="35" Height="30" Click="CloseButton_Click"/>
            </StackPanel>
        </DockPanel>

        <Grid Margin="10,75,10,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="73*"/>
                <ColumnDefinition Width="130*"/>
                <ColumnDefinition Width="93*"/>
            </Grid.ColumnDefinitions>

            <!-- LABEL DATA -->
            <ui:Card Padding="20" VerticalAlignment="Top" Height="591">
                <StackPanel Height="570">
                    <TextBlock Text="Label Data" FontSize="18" FontWeight="Bold" Margin="10,0,0,10"/>
                    <Border Height="2" Background="#FF008896" Margin="0,0,0,10"/>

                    <!-- <ui:TextBox PlaceholderText="Title" Text="{Binding Title, UpdateSourceTrigger=PropertyChanged}" Icon="TextDescription24" Margin="0,8"/> -->
                    <!-- <ui:TextBox PlaceholderText="Name" Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}" Icon="Person24" Margin="0,8"/> -->
                    <!-- <ui:TextBox PlaceholderText="Phone Number" Text="{Binding PhoneNumber, UpdateSourceTrigger=PropertyChanged}" Icon="Call24" Margin="0,8"/> -->
                    <!-- <ui:TextBox PlaceholderText="Email" Text="{Binding Email, UpdateSourceTrigger=PropertyChanged}" Icon="Mail24" Margin="0,8"/> -->
                    <!-- <ui:TextBox PlaceholderText="Company" Text="{Binding Company, UpdateSourceTrigger=PropertyChanged}" Icon="Building24" Margin="0,8"/> -->
                    <!-- <ui:TextBox PlaceholderText="QR Code Content" Text="{Binding QR, UpdateSourceTrigger=PropertyChanged}" Icon="QrCode24" Margin="0,8"/> -->
                </StackPanel>
            </ui:Card>

            <!-- EXCEL -->
            <ui:Card Margin="10,0,10,0" VerticalAlignment="Top" Height="591" Grid.Column="1">
                <StackPanel>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Import Excel Data" FontSize="18" FontWeight="Bold" Margin="10,0,330,0"/>
                        <ui:Button Content="Import Excel"
                                   Icon="TableAdd24"
                                   Appearance="Primary"
                                   Command="{Binding ImportExcelCommand}"
                                   Background="#008896"/>
                    </StackPanel>

                    <Border Height="2" Background="#FF008896" Margin="0,10,0,10"/>
                    <DataGrid ItemsSource="{Binding ExcelData}" AutoGenerateColumns="True"
                              SelectedItem="{Binding SelectedExcelRow}" Height="503"/>
                </StackPanel>
            </ui:Card>

            <!-- LABEL PREVIEW -->
            <Grid Grid.Column="2" Margin="1,133,10,92">
                <ui:Card Margin="0,-132,0,0" VerticalAlignment="Top" Height="615">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Label Preview" FontSize="18" FontWeight="Bold" Margin="10,0,180,10"/>
                            <ui:Button Content="Select Label"
                                       Icon="TableAdd24"
                                       Appearance="Primary"
                                       Command="{Binding SelectLabelCommand}"
                                       Background="#008896"/>
                        </StackPanel>
                        <Border Height="2" Background="#FF008896" Margin="0,10,0,10"/>
                        <Viewbox Stretch="Uniform" Height="500" Width="400">
                            <Image Source="{Binding LabelPreviewImage}"/>
                        </Viewbox>
                    </StackPanel>
                </ui:Card>
            </Grid>

            <!-- PRINTING -->
            <ui:Card Height="76" Grid.Column="1" Margin="432,625,2,0" VerticalAlignment="Top" Grid.ColumnSpan="2">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                    <ComboBox ItemsSource="{Binding Printers}" SelectedItem="{Binding SelectedPrinter}"
                              Width="200" Margin="0,0,20,0" FontSize="14" Foreground="Black" Background="White" BorderBrush="#CCCCCC" BorderThickness="1"/>
                    <ui:Button Content="Settings"
                               Appearance="Secondary"
                               Icon="Settings24"
                               Command="{Binding OpenSettingsCommand}"
                               Margin="0,0,70,0"/>
                    <ui:TextBox Text="{Binding Amount, UpdateSourceTrigger=PropertyChanged}"
                                Width="120" PlaceholderText="Amount"
                                Icon="NumberRow24" Margin="0,0,20,0"/>
                    <ui:Button Content="Print All"
                               Appearance="Primary"
                               Foreground="White"
                               Icon="Printer24"
                               Command="{Binding PrintAllCommand}"
                               Margin="0,0,15,0"/>
                    <ui:Button Content="Print"
                               Appearance="Success"
                               Foreground="White"
                               Icon="Print24"
                               Command="{Binding PrintCommand}"
                               Margin="0,0,0,0"/>
                </StackPanel>
            </ui:Card>
        </Grid>
    </Grid>
</ui:FluentWindow>
